# Sql拦截器 #

## 创建拦截器

* Create fireWall

	* 语法描述

	```sql
	create firewall fw_name [on schema_name.*] [FULL_UPDATE | FULL_DELTE | ...] [for user_name] {deny|allow|error} priority num;
	```

	* 语句说明

	根据可选条件过滤语句，priority后的数字越小优先级越高，最小为1。
	语句类型有：
	```sql
	    FULL_SELECT,FULL_UPDATE,FULL_DELETE,FULL_INSERT,LOCK_TABLES,UNLOCK_TABLES,FULL_REPLACE,FULL_MERGE,FULL_SET,SHOW,CREATE_BACKEND,ALTER_BACKEND,CREATE_MAPPING_INDEX,
     CREATE_MAPPING_SEQUENCE,DIRECT_BACKEND_COMMAND,DROP_MAPPING_INDEX,DROP_ISOMERISM_INDEX,CREATE_ISOMERISM_INDEX,CREATE_REPORT,DROP_BACKEND,STOP_REPORT,DROP_REPORT,
     CREATE_EXTERN_TABLE,CREATE_TENANT,ALTER_TENANT,DROP_TENANT,SELECT_WHERE_ALWAYS_TRUE,SELECT_HAVING_ALWAYS_TRUE,DELECT_WHERE_ALWAYS_TRUE,DELECT_WHERE_NONE,
     UPDATE_WHERE_ALWAYS_TRUE,UPDATE_WHERE_NONE,SELECT_WHERE_NONE,INSERT_SELECT_WHERE_NONE,INSERT_SELECT_WHERE_ALWAYS_TRUE,INSERT_SELECT_HAVING_ALWAYS_TRUE,ALTER_INDEX_RENAME,ALTER_SCHEMA_RENAME,
     ALTER_TABLE_ADD_CONSTRAINT_CHECK,ALTER_TABLE_ADD_CONSTRAINT_UNIQUE,ALTER_TABLE_ADD_CONSTRAINT_REFERENTIAL,ALTER_TABLE_ADD_CONSTRAINT_PRIMARY_KEY,ALTER_TABLE_ADD_COLUMN,
     ALTER_TABLE_ALTER_COLUMN_NOT_NULL,ALTER_TABLE_ALTER_COLUMN_NULL,ALTER_TABLE_ALTER_COLUMN_DEFAULT,ALTER_TABLE_ALTER_COLUMN_CHANGE_TYPE,ALTER_TABLE_DROP_COLUMN,
     ALTER_TABLE_ALTER_COLUMN_SELECTIVITY,ALTER_TABLE_DROP_CONSTRAINT,ALTER_TABLE_RENAME,ALTER_TABLE_ALTER_COLUMN_RENAME,ALTER_USER_ADMIN,ALTER_USER_RENAME,
     ALTER_USER_SET_PASSWORD,ALTER_VIEW,ANALYZE,CREATE_AGGREGATE,CREATE_CONSTANT,CREATE_ALIAS,CREATE_INDEX,CREATE_LINKED_TABLE,CREATE_ROLE,CREATE_SCHEMA,CREATE_SEQUENCE,
     CREATE_TABLE,CREATE_TRIGGER,CREATE_USER,CREATE_DOMAIN,CREATE_VIEW,DEALLOCATE,DROP_AGGREGATE,DROP_CONSTANT,DROP_ALL_OBJECTS,DROP_ALIAS,DROP_INDEX,DROP_ROLE,
     DROP_SCHEMA,DROP_SEQUENCE,DROP_TABLE,DROP_TRIGGER,DROP_USER,DROP_DOMAIN,DROP_VIEW,GRANT,REVOKE,PREPARE,COMMENT,TRUNCATE_TABLE,ALTER_SEQUENCE,ALTER_TABLE_SET_REFERENTIAL_INTEGRITY,
     BACKUP,CALL,DELETE,EXECUTE,EXPLAIN,INSERT,MERGE,REPLACE,NO_OPERATION,RUNSCRIPT,SCRIPT,SET_AUTOCOMMIT_TRUE,SET_AUTOCOMMIT_FALSE,COMMIT,ROLLBACK,CHECKPOINT,
     SAVEPOINT,ROLLBACK_TO_SAVEPOINT,CHECKPOINT_SYNC,PREPARE_COMMIT,COMMIT_TRANSACTION,ROLLBACK_TRANSACTION,SHUTDOWN,SHUTDOWN_IMMEDIATELY,SHUTDOWN_COMPACT,
     BEGIN,SHUTDOWN_DEFRAG,ALTER_TABLE_RENAME_CONSTRAINT    
	```

	* 应用实例
	```sql
	vds> select * from T1  where 1=1;
    +------+------------+------+
    | A    | B          | C    |
    +------+------------+------+
    |    4 | 2018-09-12 |    4 |
    |    6 | 2016-03-26 |    3 |
    |    0 | 2016-04-11 |    4 |
    +------+------------+------+
    3 rows in set (0.29 sec)
    
    vds> set firewallstate on;
    Query OK, 0 rows affected (0.01 sec)
    
    vds> create firewall wall2 on s1.T1   for vds deny priority 1;
    Query OK, 0 rows affected (0.01 sec)
    
    vds> select * from T1  where 1=1;
    +------+
    | NULL |
    +------+
    | NULL |
    +------+
    1 row in set (0.01 sec)
    
    vds>set firewallstate off;
    Query OK, 0 rows affected (0.00 sec)
    
    vds>
    
	```